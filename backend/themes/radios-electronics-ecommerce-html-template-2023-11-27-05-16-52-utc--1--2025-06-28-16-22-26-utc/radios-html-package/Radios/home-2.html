<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="description" content="" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title></title>
    <link
      rel="shortcut icon"
      href="assets/img/favicon.png"
      type="images/x-icon"
    />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/fontawesome.css" />
    <link rel="stylesheet" href="assets/css/animate.css" />
    <link rel="stylesheet" href="assets/css/metisMenu.css" />
    <link rel="stylesheet" href="assets/css/uikit.min.css" />
    <link rel="stylesheet" href="assets/css/jquery-ui.css" />
    <link rel="stylesheet" href="assets/css/slick.css" />
    <link rel="stylesheet" href="assets/css/magnific-popup.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        document
          .querySelectorAll("a[href$='.html']:not(.lang-btn)")
          .forEach((a) => {
            const href = a.getAttribute("href");
            const page = href.replace(/\.html$/, "");
            if (page === "index" || page === "") {
              a.setAttribute("href", "http://srv689968.hstgr.cloud//");
            } else {
              a.setAttribute("href", `http://srv689968.hstgr.cloud//${page}`);
            }
            a.addEventListener("click", (e) => {
              e.preventDefault();
              if (page === "index" || page === "") {
                window.parent.location.href = "http://srv689968.hstgr.cloud//";
              } else {
                window.parent.location.href = `http://srv689968.hstgr.cloud//${page}`;
              }
            });
          });
        document.querySelectorAll('a[href="#"]').forEach((a) => {
          a.addEventListener("click", (e) => e.preventDefault());
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        fetch("/themeoptionsdata")
          .then((res) => {
            if (!res.ok) throw new Error("Fetch failed");
            return res.json();
          })
          .then((data) => {
            let titleTag = document.head.querySelector("title");
            if (!titleTag) {
              titleTag = document.createElement("title");
              document.head.appendChild(titleTag);
            }
            titleTag.textContent =
              data.site_title || data.seo_title || "Website";

            let desc = document.querySelector('meta[name="description"]');
            if (!desc) {
              desc = document.createElement("meta");
              desc.name = "description";
              document.head.appendChild(desc);
            }
            desc.content = data.seo_description || "";

            let og = document.querySelector('meta[property="og:image"]');
            if (!og) {
              og = document.createElement("meta");
              og.setAttribute("property", "og:image");
              document.head.appendChild(og);
            }
            og.content = data.seo_og_image_url || "";

            const url = `/uploads/${
              data.lazy_placeholder_image
            }?v=${Date.now()}`;
            const oldIcon = document.querySelector(
              'link[rel="icon"], link[rel="shortcut icon"]'
            );
            if (oldIcon) oldIcon.remove();

            const link = document.createElement("link");
            link.rel = "icon";
            link.type = "image/png";
            link.href = url;
            document.head.appendChild(link);
          })
          .catch((e) => console.error("Theme load error:", e));
      });
    </script>
  </head>

  <style>
    .product-cat__img img {
      width: 130px;
      height: 130px;
    }

    .weekly-product__img {
      width: 334px !important;
      height: 310px;
    }

    .weekly-product__img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .rd-side__img img {
      width: 267px;
      height: 181px;
    }

    .weekly-product__wrap {
      height: 100%;
    }

    .countdown.style-2 {
      display: flex;
      gap: 1rem;
      justify-content: center;
      padding: 1rem 0;
    }

    .countdown.style-2 .time-box {
      width: 38px;
      height: 38px;
      border: 2px solid #ddd;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .countdown.style-2 .time-box:hover {
      background-color: #ff8717;
    }

    .countdown.style-2 .time-box .time {
      font-weight: bold;
    }

    .countdown.style-2 .time-box .time:hover {
      color: #fff;
    }

    .countdown.style-2 .time-box .label {
      font-size: 0.6rem;
      margin-top: 4px;
      color: #888;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .countdown.style-2 .time-box {
      position: relative;
    }

    .countdown.style-2 .time-box .label {
      position: absolute;
      bottom: -31px;
      left: 0;
      width: 100%;
      text-align: center;
      display: block;
      margin: 0;
      color: #888;
      font-size: 11px;
      font-weight: bolder;
    }

    .countdown.style-2 .time-box .time {
      margin-bottom: 4px;
    }

    .rd-side__product {
      height: 100%;
    }

    .add-banner__img img {
      width: 248px;
      height: 237px;
    }

    .product__item.style-2 {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .product__item.style-2 .product__img {
      flex: 0 0 auto;
    }

    .product__item.style-2 .product__content {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
    }

    .product__item.style-2 .product__content .product__price,
    .product__item.style-2 .product__content .badge-skew {
      margin-top: auto;
    }

    .vd-banner__item-one img {
      width: 213px;
      height: 210px;
      object-fit: contain;
    }

    .vd-banner__item-two2 img {
      width: 233px;
      height: 172px;
      object-fit: contain;
    }

    #tractor-products-container {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 20px;
      scroll-behavior: smooth;
    }

    #tractor-products-container::-webkit-scrollbar {
      display: none;
    }

    .tab-product__item {
      flex: 0 0 auto;
      width: 225px;
    }
  </style>

  <body>
    <div class="body_wrap">
      <div class="preloder_part">
        <div class="spinner">
          <div class="dot1"></div>
          <div class="dot2"></div>
        </div>
      </div>

      <div class="progress-wrap">
        <svg
          class="progress-circle svg-content"
          width="100%"
          height="100%"
          viewBox="-1 -1 102 102"
        >
          <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
        </svg>
      </div>

      <header class="header header__style-two">
        <div class="header__top-wrap">
          <div class="container mxw_1530">
            <div class="header__top-info ul_li_between mt-none-10">
              <ul class="header__top-left ul_li mt-10">
                <li><a href="#!">Call us</a> free 24/7 : (555) 172-244-7888</li>
                <li><i class="fas fa-envelope"></i> adminpath@gmail.com</li>
              </ul>
              <ul class="header__top-right ul_li mt-10">
                <li><i class="fas fa-clouds"></i>30 degree</li>
                <li><i class="far fa-city"></i>New York</li>
                <li>
                  <a href="#!"><i class="fas fa-star"></i>My Wishlist</a>
                </li>
                <li>
                  <a href="checkout.html"
                    ><i class="far fa-check-circle"></i>Checkout</a
                  >
                </li>
                <li>
                  <div class="header__language currency">
                    <ul>
                      <li>
                        <a href="#!" class="lang-btn"
                          ><img src="assets/img/icon/usd_flag.png" alt="" />USD
                          <i class="far fa-chevron-down"></i
                        ></a>
                        <ul class="lang_sub_list">
                          <li><a href="#">USD</a></li>
                          <li><a href="#">BDT</a></li>
                          <li><a href="#">EUR</a></li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="container mxw_1530">
          <div class="header__middle ul_li_between">
            <div class="header__logo">
              <a href="index.html">
                <img src="assets/img/logo/logo.svg" alt="" />
              </a>
            </div>

            <div class="header-date" id="current-date">
              <i class="far fa-calendar-alt"></i>
            </div>

            <script>
              document.addEventListener("DOMContentLoaded", function () {
                const dateElement = document.getElementById("current-date");

                const days = [
                  "Sunday",
                  "Monday",
                  "Tuesday",
                  "Wednesday",
                  "Thursday",
                  "Friday",
                  "Saturday",
                ];
                const months = [
                  "January",
                  "February",
                  "March",
                  "April",
                  "May",
                  "June",
                  "July",
                  "August",
                  "September",
                  "October",
                  "November",
                  "December",
                ];

                const now = new Date();
                const dayName = days[now.getDay()];
                const monthName = months[now.getMonth()];
                const date = now.getDate();
                const year = now.getFullYear();

                dateElement.innerHTML = `<i class="fal fa-calendar-alt"></i> ${dayName}, ${monthName} ${date}, ${year}`;
              });
            </script>

            <div class="add">
              <a href="#!">
                <img src="assets/img/add/img_01.jpg" alt="" />
              </a>
            </div>
            <div class="d-none d-lg-block">
              <div class="ul_li">
                <div class="header__language style-2 mr-25">
                  <ul>
                    <li>
                      <a href="#!" class="lang-btn"
                        ><img src="assets/img/icon/usd_flag.png" alt="" />
                        English <i class="far fa-chevron-down"></i
                      ></a>
                      <ul class="lang_sub_list">
                        <li><a href="#">English</a></li>
                        <li><a href="#">Arabic</a></li>
                        <li><a href="#">Bangla</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="header__social">
                  <a href="#!"><i class="fab fa-facebook-f"></i></a>
                  <a href="#!"><i class="fab fa-twitter"></i></a>
                  <a href="#!"><i class="fab fa-instagram"></i></a>
                  <a href="#!"><i class="fab fa-youtube"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="header__wrap"
          data-uk-sticky="top: 250; animation: uk-animation-slide-top;"
        >
          <div class="container mxw_1530">
            <div class="header__main ul_li">
              <div class="header__logo">
                <a href="index.html">
                  <img src="assets/img/logo/logo.svg" alt="" />
                </a>
              </div>
              <div class="header__category pos-rel">
                <div class="vertical-menu">
                  <button class="header__category-nav">
                    <img class="bar" src="assets/img/icon/bar.svg" alt="" />
                    Browse Catetory
                    <i class="fas fa-chevron-down"></i>
                  </button>
                  <div class="vertical-menu-list category-nav">
                    <ul class="category-nav__list list-unstyled">
                      <li>
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_01.svg"
                            alt=""
                          />Bluetooth speaker</a
                        >
                      </li>
                      <li class="menu-item-has-children">
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_02.svg"
                            alt=""
                          />Digital camera</a
                        >
                        <ul>
                          <li><a href="#">Electric razor</a></li>
                          <li><a href="#">Digital camera</a></li>
                          <li><a href="#">Electric frying pan</a></li>
                          <li><a href="#">external hard drive</a></li>
                        </ul>
                      </li>
                      <li>
                        <a href="#"
                          ><img src="assets/img/icon/cat_03.svg" alt="" />Laser
                          printer</a
                        >
                      </li>
                      <li class="menu-item-has-children">
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_04.svg"
                            alt=""
                          />Electric frying pan</a
                        >
                        <ul>
                          <li><a href="#">Electric razor</a></li>
                          <li><a href="#">Digital camera</a></li>
                          <li><a href="#">Electric frying pan</a></li>
                          <li><a href="#">external hard drive</a></li>
                        </ul>
                      </li>
                      <li>
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_05.svg"
                            alt=""
                          />Robotics vacuum</a
                        >
                      </li>
                      <li class="menu-item-has-children">
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_06.svg"
                            alt=""
                          />external hard drive</a
                        >
                        <ul>
                          <li><a href="#">Electric razor</a></li>
                          <li><a href="#">Digital camera</a></li>
                          <li><a href="#">Electric frying pan</a></li>
                          <li><a href="#">external hard drive</a></li>
                        </ul>
                      </li>
                      <li>
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_07.svg"
                            alt=""
                          />Electric razor</a
                        >
                      </li>
                      <li>
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_08.svg"
                            alt=""
                          />Washing machine</a
                        >
                      </li>
                      <li>
                        <a href="#"
                          ><img src="assets/img/icon/cat_09.svg" alt="" />Rice
                          cooker</a
                        >
                      </li>
                      <li>
                        <a href="#"
                          ><img
                            src="assets/img/icon/cat_10.svg"
                            alt=""
                          />Telivsion & Monitor</a
                        >
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="hamburger_menu d-lg-none">
                <a href="javascript:void(0);" class="active">
                  <div class="icon bar">
                    <span><i class="fal fa-bars"></i></span>
                  </div>
                </a>
              </div>
              <div class="main-menu navbar navbar-expand-lg">
                <nav class="main-menu__nav collapse navbar-collapse">
                  <ul>
                    <li class="menu-item-has-children has-mega-menu active">
                      <a href="index.html">Home</a>
                      <ul class="mega-menu">
                        <li>
                          <div class="mega-menu-content mxw_1505">
                            <div class="row">
                              <div class="col col-md-3">
                                <div class="demo-pic">
                                  <a href="index.html">
                                    <img
                                      src="assets/img/demo/demo-1.jpg"
                                      alt=""
                                    />
                                  </a>
                                </div>
                                <h3>#Home Demo 1</h3>
                              </div>
                              <div class="col col-md-3">
                                <div class="demo-pic">
                                  <a href="home-2.html">
                                    <img
                                      src="assets/img/demo/demo-2.jpg"
                                      alt=""
                                    />
                                  </a>
                                </div>
                                <h3>#Home Demo 2</h3>
                              </div>
                              <div class="col col-md-3">
                                <div class="demo-pic">
                                  <a href="home-3.html">
                                    <img
                                      src="assets/img/demo/demo-3.jpg"
                                      alt=""
                                    />
                                  </a>
                                </div>
                                <h3>#Home Demo 3</h3>
                              </div>
                              <div class="col col-md-3">
                                <div class="demo-pic coming-soon">
                                  <span>Coming Soon</span>
                                </div>
                                <h3>Coming Soon</h3>
                              </div>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </li>
                    <li class="menu-item-has-children">
                      <a href="#!">Shop</a>
                      <ul class="submenu">
                        <li><a href="shop.html">Shop Default</a></li>
                        <li>
                          <a href="shop-left-sidebar.html">Shop Left Sidebar</a>
                        </li>
                        <li><a href="shop-single.html">Shop Single</a></li>
                        <li><a href="cart.html">Shop Cart</a></li>
                        <li><a href="checkout.html">Shop Checkout</a></li>
                        <li><a href="account.html">Account</a></li>
                      </ul>
                    </li>
                    <li><a href="shop.html">Accesories</a></li>
                    <li class="menu-item-has-children">
                      <a href="#!">Blog</a>
                      <ul class="submenu">
                        <li><a href="news.html">Blog</a></li>
                        <li><a href="news-single.html">Blog Details</a></li>
                      </ul>
                    </li>
                    <li class="menu-item-has-children">
                      <a href="#!">Pages</a>
                      <ul class="submenu">
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="account.html">Account</a></li>
                        <li><a href="404.html">404</a></li>
                      </ul>
                    </li>
                    <li><a href="contact.html">Contact</a></li>
                  </ul>
                </nav>
              </div>

              <div class="header__main-right ul_li">
                <form class="header__search mr-30" action="#!">
                  <input type="text" placeholder="Search........" />
                  <button><i class="far fa-search"></i></button>
                </form>

                <div class="header__icons ul_li mr-15">
                  <div class="icon">
                    <a href="account.html">
                      <img src="assets/img/icon/user.svg" alt="" />
                    </a>
                  </div>

                  <div class="icon wishlist-icon">
                    <a href="#!">
                      <img src="assets/img/icon/heart.svg" alt="Wishlist" />
                      <span id="wishlist-data" class="count">0</span>
                    </a>
                  </div>

                  <div class="icon cart-icon">
                    <a href="cart.html">
                      <img src="assets/img/icon/bookmark.svg" alt="" />
                      <span id="cart-data" class="count">0</span>
                    </a>
                  </div>
                </div>

                <div class="login-sign-btn">
                  <a class="thm-btn thm-btn__2 text-black" href="account.html">
                    <span class="btn-wrap">
                      <span>Login / Sign Up</span>
                      <span>Login / Sign Up</span>
                    </span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <aside class="slide-bar">
        <div class="close-mobile-menu">
          <a href="javascript:void(0);"><i class="fal fa-times"></i></a>
        </div>

        <div class="cart_sidebar">
          <button type="button" class="cart_close_btn">
            <i class="fal fa-times"></i>
          </button>
          <h2 class="heading_title text-uppercase">
            Cart Items - <span>0</span>
          </h2>

          <div class="cart_items_list"></div>

          <div class="total_price text-uppercase">
            <span>Sub Total:</span>
            <span>$00.00</span>
          </div>

          <ul class="btns_group ul_li">
            <li>
              <a href="cart.html" class="thm-btn">
                <span class="btn-wrap">
                  <span>View Cart</span>
                  <span>View Cart</span>
                </span>
              </a>
            </li>
            <li>
              <a href="checkout.html" class="thm-btn thm-btn__black">
                <span class="btn-wrap">
                  <span>Checkout</span>
                  <span>Checkout</span>
                </span>
              </a>
            </li>
          </ul>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const wishlistCountEl = document.getElementById("wishlist-data");
            const cartCountEl = document.getElementById("cart-data");

            const cartListEl = document.querySelector(
              ".cart_sidebar .cart_items_list"
            );
            const subtotalEl = document.querySelector(
              ".cart_sidebar .total_price span:last-child"
            );
            const sidebarCountEl = document.querySelector(
              ".cart_sidebar h2 span"
            );
            const headerCartCount = cartCountEl;

            async function loadWishlist() {
              try {
                const res = await fetch("/wishlistdata");
                const data = await res.json();
                if (!Array.isArray(data)) return;

                const uniqueNames = new Set(
                  data.map((item) => item.product_name)
                );

                wishlistCountEl.textContent = uniqueNames.size;
              } catch (err) {
                console.error("Wishlist Load Error:", err);
              }
            }

            async function loadCart() {
              try {
                const res = await fetch("/allcartdata");
                const data = await res.json();
                if (!Array.isArray(data)) return;

                const seen = new Set();
                const unique = [];
                let subtotal = 0;

                for (let item of data) {
                  if (!seen.has(item.name)) {
                    seen.add(item.name);
                    unique.push(item);
                    subtotal += parseFloat(item.price.replace("$", "")) || 0;
                  }
                }

                cartListEl.innerHTML = unique
                  .map(
                    (item) => `
                  <div class="cart_item" data-id="${item.id}">
                    <div class="item_image">
                      <img src="/uploads/${
                        item.image || "assets/img/product/default.png"
                      }" />
                    </div>
                    <div class="item_content">
                      <h4 class="item_title">${item.name}</h4>
                      <span class="item_price">${item.price}</span>
                      <button type="button" class="remove_btn">
                        <i class="fal fa-times"></i>
                      </button>
                    </div>
                  </div>
                `
                  )
                  .join("");

                const count = unique.length;
                cartCountEl.textContent = count;
                sidebarCountEl.textContent = count;
                subtotalEl.textContent = subtotal.toFixed(2);
              } catch (err) {
                console.error("Cart Load Error:", err);
              }
            }

            cartListEl.addEventListener("click", async (e) => {
              const btn = e.target.closest(".remove_btn");
              if (!btn) return;

              const itemEl = btn.closest(".cart_item");
              const id = itemEl.dataset.id;

              try {
                const res = await fetch(`/deletecart/${id}`, {
                  method: "DELETE",
                });
                const json = await res.json();
                if (res.ok && json.success) {
                  loadCart();
                } else {
                  console.error("Delete failed:", json.message);
                }
              } catch (err) {
                console.error("Delete request error:", err);
              }
            });

            document
              .querySelector('a[href="checkout.html"]')
              ?.addEventListener("click", () => {
                const items = Array.from(
                  cartListEl.querySelectorAll(".cart_item")
                ).map((el) => {
                  const price =
                    parseFloat(
                      el
                        .querySelector(".item_price")
                        .textContent.replace("$", "")
                    ) || 0;
                  return {
                    id: el.dataset.id,
                    name: el.querySelector(".item_title").textContent,
                    price,
                    quantity: 1,
                    lineTotal: price,
                    image: el
                      .querySelector("img")
                      .getAttribute("src")
                      .replace("/uploads/", ""),
                  };
                });
                const subtotal = parseFloat(subtotalEl.textContent) || 0;
                localStorage.setItem(
                  "checkout_cart",
                  JSON.stringify({ items, subtotal, total: subtotal })
                );
              });

            loadWishlist();
            loadCart();
            setInterval(loadWishlist, 3000);
            setInterval(loadCart, 3000);
          });
        </script>

        <nav class="side-mobile-menu">
          <div class="header-mobile-search">
            <form role="search" method="get" action="#">
              <input type="text" placeholder="Search Keywords" />
              <button type="submit"><i class="ti-search"></i></button>
            </form>
          </div>
          <ul id="mobile-menu-active">
            <li class="dropdown">
              <a href="index.html">Home</a>
              <ul class="sub-menu">
                <li><a href="index.html">Home One</a></li>
                <li><a href="home-2.html">Home Two</a></li>
                <li><a href="home-3.html">Home Three</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#">Shop</a>
              <ul class="sub-menu">
                <li><a href="shop.html">Shop Default</a></li>
                <li><a href="shop-left-sidebar.html">Shop Left Sidebar</a></li>
                <li><a href="shop-single.html">Shop Single</a></li>
                <li><a href="cart.html">Shop Cart</a></li>
                <li><a href="checkout.html">Shop Checkout</a></li>
                <li><a href="account.html">Account</a></li>
              </ul>
            </li>
            <li><a href="shop.html">Accesories</a></li>
            <li class="dropdown">
              <a href="#!">Blog</a>
              <ul class="sub-menu">
                <li><a href="news.html">Blog</a></li>
                <li><a href="news-single.html">Blog Details</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#!">Pages</a>
              <ul class="submenu">
                <li><a href="about.html">About Us</a></li>
                <li><a href="account.html">Account</a></li>
                <li><a href="404.html">404</a></li>
              </ul>
            </li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </nav>
      </aside>

      <div class="body-overlay"></div>

      <main>
        <div class="featured pt-10">
          <div class="container mxw_1530">
            <div class="row mt-none-30">
              <div class="col-lg-9 mt-30">
                <div
                  class="featured__item featured__big bg_img ul_li_between"
                  data-background="assets/img/bg/bg_06.jpg"
                >
                  <div class="featured__content">
                    <span>Widesceen 4k .......</span>
                    <h2>
                      Digital Slr Camera <br />
                      High Defination
                    </h2>
                    <p>Sumptuous, filling, and temptingly</p>
                    <div class="ul_li mt-20">
                      <div class="upto-offer ul_li">
                        <span class="upto"
                          >Up <br />
                          To</span
                        >
                        <span class="offer-no">70 <span>%</span></span>
                      </div>
                      <h4 class="price">$ 180.99</h4>
                    </div>
                    <div class="banner__btn mt-30">
                      <a class="thm-btn thm-btn__black" href="shop.html">
                        <span class="btn-wrap">
                          <span>Shop Now</span>
                          <span>Shop Now</span>
                        </span>
                        <i class="far fa-long-arrow-right"></i>
                      </a>
                    </div>
                  </div>
                  <div class="featured__img">
                    <img src="assets/img/product/img_56.png" alt="" />
                  </div>
                  <div class="featured__shape">
                    <img src="assets/img/icon/h_01.png" alt="" />
                  </div>
                </div>
              </div>
              <div class="col-lg-3 mt-30">
                <div
                  class="add-banner bg_img add-banner__2 add-banner__h555"
                  data-background="assets/img/bg/bg_07.jpg"
                >
                  <span>New</span>
                  <h2>Cloud Cam, <br />Security Camera</h2>
                  <div class="upto-offer ul_li mb-35">
                    <span class="upto"
                      >Up <br />
                      To</span
                    >
                    <span class="offer-no">70 <span>%</span></span>
                  </div>
                  <a class="thm-btn thm-btn__transparent" href="shop.html">
                    <span class="btn-wrap">
                      <span>Shop Now</span>
                      <span>Shop Now</span>
                    </span>
                    <i class="far fa-long-arrow-right"></i>
                  </a>
                  <div class="add-banner__img">
                    <img src="assets/img/product/img_57.png" alt="" />
                  </div>
                  <div class="add-banner__text-box">
                    25% <br />
                    <span>off</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="banner-product">
          <div class="container mxw_1530 pt-45">
            <div class="row mt-none-30"></div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", async () => {
            try {
              const res = await fetch("/flashsalesmaindata");
              const products = await res.json();
              if (!Array.isArray(products)) return;

              const sizes = [
                { width: 148, height: 116 },
                { width: 139, height: 126 },
                { width: 113, height: 131 },
                { width: 123, height: 127 },
              ];

              const sliced = products.slice(0, 4);
              const container = document.querySelector(".banner-product .row");

              sliced.forEach((product, index) => {
                const { width, height } = sizes[index] || {
                  width: 120,
                  height: 120,
                };

                const col = document.createElement("div");
                col.className = "col-lg-3 col-md-6 mt-30";

                col.innerHTML = `
                  <div class="banner-product__item ul_li bg_img" style="background-image: url('assets/img/bg/bg_08.jpg')">
                    <div class="banner-product__img">
                      <img src="/uploads/${product.image}" alt="${
                  product.product_name
                }" style="width: ${width}px; height: ${height}px;" />
                    </div>
                    <div class="banner-product__content">
                      <h2>
                        ${product.name}<br />
                        <span>${product.label || "Deal"}</span> on this
                      </h2>
                     <div class="upto-offer ul_li mb-10">
                      <span class="upto">Up <br />To</span>
                      <span class="offer-no">${Math.round(
                        parseFloat(product.price_sale.replace(/[^0-9.]/g, ""))
                      )} <span>%</span></span>
                     </div>
                      <a href="shop.html">
                        Shop Now <i class="fas fa-chevron-circle-right"></i>
                      </a>
                    </div>
                  </div>
                `;
                container.appendChild(col);
              });
            } catch (error) {
              console.error("Error loading flash sales data:", error);
            }
          });
        </script>

        <div class="pt-40">
          <div class="container mxw_1530">
            <div class="row mt-none-30">
              <div class="col-lg-3 mt-30">
                <div class="tx-widget__wrap pr-90">
                  <div class="tx-widget widget__product">
                    <h2 class="section-heading mb-20 fs-18">
                      <span>Latest Item</span>
                    </h2>
                    <div class="tx-widget__product-slide tx-arrow"></div>
                  </div>
                </div>
              </div>

              <div class="col-lg-9 mt-30">
                <div class="tx-product-style-01">
                  <div class="tx-product-wrap">
                    <div class="product__nav-wrap style-3 ul_li_between mb-20">
                      <h2 class="section-heading">
                        <span>Used <span>Car</span> Area</span>
                      </h2>
                      <ul
                        class="product__nav nav nav-tabs"
                        id="myTab3"
                        role="tablist"
                      >
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            id="ctx-tab-01"
                            data-bs-toggle="tab"
                            data-bs-target="#ctx-tab1"
                            type="button"
                            role="tab"
                            aria-controls="ctx-tab1"
                            aria-selected="true"
                          >
                            Recent
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            id="ctx-tab-02"
                            data-bs-toggle="tab"
                            data-bs-target="#ctx-tab2"
                            type="button"
                            role="tab"
                            aria-controls="ctx-tab2"
                            aria-selected="false"
                          >
                            Best Seller
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link active"
                            id="ctx-tab-03"
                            data-bs-toggle="tab"
                            data-bs-target="#ctx-tab3"
                            type="button"
                            role="tab"
                            aria-controls="ctx-tab3"
                            aria-selected="false"
                          >
                            Top
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            id="ctx-tab-04"
                            data-bs-toggle="tab"
                            data-bs-target="#ctx-tab4"
                            type="button"
                            role="tab"
                            aria-controls="ctx-tab4"
                            aria-selected="false"
                          >
                            New Arrivals
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            id="ctx-tab-05"
                            data-bs-toggle="tab"
                            data-bs-target="#ctx-tab5"
                            type="button"
                            role="tab"
                            aria-controls="ctx-tab5"
                            aria-selected="false"
                          >
                            top rating
                          </button>
                        </li>
                      </ul>
                    </div>

                    <div class="tab-content">
                      <div
                        class="tab-pane animated fadeInUp"
                        id="ctx-tab1"
                        role="tabpanel"
                        aria-labelledby="ctx-tab-01"
                      >
                        <div class="row g-0"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="ctx-tab2"
                        role="tabpanel"
                        aria-labelledby="ctx-tab-02"
                      >
                        <div class="row g-0"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp show active"
                        id="ctx-tab3"
                        role="tabpanel"
                        aria-labelledby="ctx-tab-03"
                      >
                        <div class="row g-0"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="ctx-tab4"
                        role="tabpanel"
                        aria-labelledby="ctx-tab-04"
                      >
                        <div class="row g-0"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="ctx-tab5"
                        role="tabpanel"
                        aria-labelledby="ctx-tab-05"
                      >
                        <div class="row g-0"></div>
                      </div>
                    </div>
                  </div>

                  <div class="row mt-none-10">
                    <div class="col-xl-6 col-lg-12 mt-30 vd-banner__item-one">
                      <div
                        class="vd-banner__item pos-rel ul_li_between bg_img"
                        data-background="assets/img/bg/bg_12.jpg"
                      >
                        <div class="content">
                          <span>Get 30% off</span>
                          <h2>Buy One. Get Free delivery</h2>
                          <h3>Starting <span>560.99</span></h3>
                          <div class="banner__btn mt-10">
                            <a href="shop.html">Shop Now</a>
                          </div>
                        </div>
                        <div class="image">
                          <img src="assets/img/product/img_79.png" alt="" />
                        </div>
                        <div class="vd-banner__offer-box">
                          25%<span>off</span>
                        </div>
                      </div>
                    </div>

                    <div class="col-xl-6 col-lg-12 mt-30 vd-banner__item-two2">
                      <div
                        class="vd-banner__item vd-banner__item-two pos-rel ul_li_between bg_img"
                        data-background="assets/img/bg/bg_13.jpg"
                      >
                        <div class="content">
                          <span>Get 30% off</span>
                          <h2>Buy One. Get Free delivery</h2>
                          <h3>Starting <span>560.99</span></h3>
                          <div class="banner__btn mt-10">
                            <a href="shop.html">Shop Now</a>
                          </div>
                        </div>
                        <div class="image">
                          <img src="assets/img/product/img_80.png" alt="" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", async () => {
            try {
              const res = await fetch("/flashsalesmaindata");
              const data = await res.json();
              if (!Array.isArray(data)) return;

              const now = new Date();

              const products = data
                .filter((p) => p.status === "Published")
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 2);

              const banner1Wrapper = document.querySelector(
                ".vd-banner__item-one"
              );
              const banner2Wrapper = document.querySelector(
                ".vd-banner__item-two2"
              );

              const banner1 = banner1Wrapper?.querySelector(".vd-banner__item");
              const banner2 = banner2Wrapper?.querySelector(
                ".vd-banner__item-two"
              );

              const isExpired = (p) => !p || new Date(p.end_date) < now;

              const bothExpired =
                isExpired(products[0]) && isExpired(products[1]);

              if (bothExpired) {
                if (banner1Wrapper) banner1Wrapper.style.display = "none";
                if (banner2Wrapper) banner2Wrapper.style.display = "none";

                const parentRow = banner1Wrapper?.parentElement?.parentElement;
                if (parentRow) {
                  const noOfferDiv = document.createElement("div");
                  noOfferDiv.className = "col-12 mt-30 text-center";
                  noOfferDiv.innerHTML = `
                    <div class="no-offer-message py-5">
                      <h3 style="font-size: 20px; color: #cc0d39; margin: 0;">No offer available</h3>
                    </div>
                  `;
                  parentRow.appendChild(noOfferDiv);
                }
                return;
              }

              const fillBanner = (wrapper, banner, product) => {
                if (!wrapper || !banner || isExpired(product)) {
                  if (wrapper) wrapper.style.display = "none";
                  return;
                }

                const bg = banner.getAttribute("data-background");
                banner.style.backgroundImage = `url(${bg})`;

                const span = banner.querySelector(".content span");
                const h2 = banner.querySelector(".content h2");
                const h3span = banner.querySelector(".content h3 span");
                const img = banner.querySelector(".image img");
                const offerBox = banner.querySelector(".vd-banner__offer-box");

                span.textContent = "Get 30% off";
                h2.textContent = product.name || "Buy One. Get Free delivery";
                h3span.textContent = product.price_sale || "0.00";
                img.src = `/uploads/${product.image}`;
                img.alt = product.name || "";
                if (offerBox) {
                  offerBox.style.display = "";
                  offerBox.innerHTML = `25%<span>off</span>`;
                }
              };

              fillBanner(banner1Wrapper, banner1, products[0]);
              fillBanner(banner2Wrapper, banner2, products[1]);
            } catch (err) {
              console.error("Failed to load flash sale data:", err);
            }
          });
        </script>

        <script>
          document.addEventListener("DOMContentLoaded", async () => {
            const widgetContainer = document.querySelector(
              ".tx-widget__product-slide"
            );
            const lightbox = document.getElementById("image-lightbox");
            const lightboxImg = document.getElementById("lightbox-image");
            const counterEl = document.getElementById("lightbox-counter");

            let prods;
            try {
              const res = await fetch("/productpagedata");
              prods = await res.json();
              prods.sort((a, b) => new Date(b.date) - new Date(a.date));
            } catch (e) {
              console.error("Could not load products", e);
              return;
            }

            const items = prods.filter(
              (p) => p.status === "Published" || p.status === "Draft"
            );

            if (widgetContainer) {
              const latest = items
                .filter((p) => p.status === "Published")
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 6);

              const slides = [[], []];
              latest.forEach((p, i) => slides[Math.floor(i / 3)].push(p));

              widgetContainer.innerHTML = slides
                .map(
                  (group) => `
                  <div class="tx-widget__product-single">
                    ${group
                      .map(
                        (p) => `
                      <div class="tx-widget__product-item tx-product ul_li mb-4">
                        <div class="thumb">
                          <a href="shop-single.html?id=${p.id}">
                            <img src="/uploads/${p.image}" alt="${p.name}" class="border"/>
                          </a>
                        </div>
                        <div class="content">
                          <h3>
                            <a href="shop-single.html?id=${p.id}">${p.name}</a>
                          </h3>
                          <h4 class="product__price">
                            <span class="new">${p.price}</span>
                            <span class="old">${p.price_sale}</span>
                          </h4>
                        </div>
                      </div>
                      `
                      )
                      .join("")}
                  </div>
                `
                )
                .join("");
            }

            const tabs = {
              1: (p) => p.label === "New",
              2: (p) => p.label === "Hot",
              3: (p) => p.label === "Sale",
              4: (p) =>
                (p.categories || "")
                  .split(",")
                  .map((s) => s.trim())
                  .includes("New Arrivals"),
              5: (p) => p.label === "New",
            };

            function buildCard(p) {
              const pct = Math.min(100, Math.max(0, p.minimumorder || 0));
              return `
                <div class="col-1-of-5">
                  <div class="product__item style-2">
                    <div class="product__img text-center pos-rel">
                      <a href="shop-single.html?id=${p.id}">
                        <img src="/uploads/${p.image}" alt="${p.name}" />
                      </a>
                      <ul class="product__action style-2 ul_li">
                        
                        <li>
                          <a href="/uploads/${
                            p.image
                          }" class="img-popup icon-btn">
                            <i class="far fa-compress-alt"></i>
                          </a>
                        </li>
                        <li>
                          <a href="#" class="add-to-cart icon-btn"
                             data-id="${p.id}"
                             data-name="${p.name}"
                             data-store="${p.store}"
                             data-price="${p.price.replace(/[^0-9.]/g, "")}"
                             data-price_sale="${p.price_sale.replace(
                               /[^0-9.]/g,
                               ""
                             )}"
                             data-image="${p.image}">
                            <i class="far fa-shopping-basket"></i>
                          </a>
                        </li>
                        <li>
                          <a href="#" class="add-to-wishlist icon-btn"
                             data-id="${p.id}"
                             data-name="${p.name}"
                             data-store="${p.store}"
                             data-price="${p.price.replace(/[^0-9.]/g, "")}"
                             data-price_sale="${p.price_sale.replace(
                               /[^0-9.]/g,
                               ""
                             )}"
                             data-image="${p.image}"
                             data-sku="${p.sku}"
                             data-stockstatus="${p.stockstatus}">
                            <i class="far fa-heart"></i>
                          </a>
                        </li>
                      </ul>
                    </div>
                    <div class="product__content">
                      <div class="product__review ul_li">
                        <ul class="rating-star ul_li mr-10">
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="far fa-star"></i></li>
                          <li><i class="far fa-star"></i></li>
                        </ul>
                        <span>(${Math.floor(Math.random() * 100)})</span>
                      </div>
                      <div class="product__progress progress mt-2 color-primary">
                        <div class="progress-bar"
                             role="progressbar"
                             style="width:${pct}%;"
                             aria-valuenow="${pct}"
                             aria-valuemin="0"
                             aria-valuemax="100">
                        </div>
                      </div>
                      <h2 class="product__title">
                        <a href="shop-single.html?id=${p.id}">${p.name}</a>
                      </h2>
                      <h4 class="product__price">
                        <span class="new">${p.price}</span>
                        <span class="old">${p.price_sale}</span>
                      </h4>
                      <span class="badge-skew">${p.label}</span>
                    </div>
                  </div>
                </div>`;
            }

            for (let i = 1; i <= 5; i++) {
              const pane = document.querySelector(`#ctx-tab${i} .row.g-0`);
              if (!pane) continue;

              const matched = items
                .filter(tabs[i])
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);

              if (matched.length === 0) {
                pane.innerHTML = `<p class="text-center w-100 py-5">No products available.</p>`;
              } else {
                pane.innerHTML = matched.map(buildCard).join("");
                pane.querySelectorAll(".progress-bar").forEach((bar) => {
                  const pct =
                    parseInt(bar.getAttribute("aria-valuenow"), 10) || 0;
                  bar.style.backgroundColor = "#ff8717";
                });
              }
            }

            const topTabBtn = document.getElementById("ctx-tab-03");
            if (topTabBtn) topTabBtn.click();

            const popupLinks = Array.from(
              document.querySelectorAll("a.img-popup")
            );
            const seen = new Set();
            const uniquePopupLinks = popupLinks.filter((a) => {
              const href = a.getAttribute("href");
              if (seen.has(href)) return false;
              seen.add(href);
              return true;
            });

            const urls = uniquePopupLinks.map((a) => a.getAttribute("href"));
            let lbIdx = 0;

            function show(i) {
              lbIdx = (i + urls.length) % urls.length;
              lightboxImg.src = urls[lbIdx];
              counterEl.textContent = `${lbIdx + 1} of ${urls.length}`;
              lightbox.style.display = "flex";
            }

            uniquePopupLinks.forEach((a, i) => {
              a.addEventListener("click", (e) => {
                e.preventDefault();
                show(i);
              });
            });

            document.getElementById("lightbox-prev").onclick = () =>
              show(lbIdx - 1);
            document.getElementById("lightbox-next").onclick = () =>
              show(lbIdx + 1);
            document.getElementById("lightbox-close").onclick = () =>
              (lightbox.style.display = "none");
            window.addEventListener("keydown", (e) => {
              if (lightbox.style.display !== "flex") return;
              if (e.key === "Escape") lightbox.style.display = "none";
              if (e.key === "ArrowLeft") show(lbIdx - 1);
              if (e.key === "ArrowRight") show(lbIdx + 1);
            });

            document.body.addEventListener("click", async (e) => {
              const cartBtn = e.target.closest(".add-to-cart");
              const wishBtn = e.target.closest(".add-to-wishlist");
              if (!cartBtn && !wishBtn) return;
              e.preventDefault();

              const userId = localStorage.getItem("user_id");
              if (!userId) {
                showBanner("Please log in to perform that action.", "error");
                return;
              }

              if (cartBtn) {
                try {
                  const res = await fetch("/addcart", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                      user_id: +userId,
                      name: cartBtn.dataset.name,
                      store: cartBtn.dataset.store,
                      price: cartBtn.dataset.price,
                      price_sale: cartBtn.dataset.price_sale,
                      image: cartBtn.dataset.image,
                      quantity: 1,
                    }),
                  });
                  if (res.ok) {
                    showBanner("Product added to cart!", "success");
                    if (typeof loadSidebarCart === "function")
                      loadSidebarCart();
                    if (typeof updateCounts === "function") updateCounts();
                  } else {
                    showBanner("Add to cart failed.", "error");
                  }
                } catch (err) {
                  console.error("Cart error:", err);
                  showBanner("Add to cart failed.", "error");
                }
                return;
              }

              if (wishBtn) {
                try {
                  const res = await fetch("/wishlistpost", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                      user_id: +userId,
                      product_name: wishBtn.dataset.name,
                      store: wishBtn.dataset.store,
                      price: wishBtn.dataset.price,
                      price_sale: wishBtn.dataset.price_sale,
                      image: wishBtn.dataset.image,
                      sku: wishBtn.dataset.sku,
                      stockstatus: wishBtn.dataset.stockstatus,
                    }),
                  });
                  if (res.ok) {
                    showBanner("Product added to wishlist!", "success");
                    if (typeof updateCounts === "function") updateCounts();
                  } else {
                    showBanner("Add to wishlist failed.", "error");
                  }
                } catch (err) {
                  console.error("Wishlist error:", err);
                  showBanner("Add to wishlist failed.", "error");
                }
                return;
              }
            });

            function showBanner(msg, type = "success") {
              document.querySelectorAll(".banner").forEach((el) => el.remove());
              const b = document.createElement("div");
              b.className = `banner ${type}`;
              b.textContent = msg;
              Object.assign(b.style, {
                position: "fixed",
                top: "10px",
                left: "50%",
                transform: "translateX(-50%)",
                padding: "10px 20px",
                background: type === "success" ? "#4caf50" : "#f44336",
                color: "#fff",
                borderRadius: "4px",
                zIndex: 9999,
                boxShadow: "0 2px 6px rgba(0,0,0,0.3)",
              });
              document.body.appendChild(b);
              setTimeout(() => b.remove(), 3000);
            }
          });
        </script>

        <div class="pt-30">
          <div class="container mxw_1530">
            <h2 class="section-heading mb-20">
              <span><span>Deals</span> Of The Day</span>
            </h2>
            <div class="row mt-none-30">
              <div class="col-lg-3 mt-30">
                <div class="add-banner__wrap mr-70">
                  <div
                    class="add-banner add-banner__3 bg_img add-banner__h530"
                    data-background="assets/img/bg/bg_15.jpg"
                  >
                    <div class="add-banner__content text-center">
                      <span>Get Save 30% off</span>
                      <h3 class="text-capitalize">
                        general motors buick <br />
                        sonic engine
                      </h3>
                      <a class="thm-btn mt-40" href="shop.html">
                        <span class="btn-wrap">
                          <span>Shop Now</span>
                          <span>Shop Now</span>
                        </span>
                        <i class="far fa-long-arrow-right"></i>
                      </a>
                    </div>
                    <div class="add-banner__img">
                      <img src="assets/img/product/img_81.png" alt="" />
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-6 mt-30">
                <div class="weekly-product__wrap">
                  <div class="weeekly-product__head pos-rel">
                    <div class="weekly-product__content">
                      <div class="product__review ul_li">
                        <ul class="rating-star ul_li mr-10">
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="fas fa-star"></i></li>
                          <li><i class="far fa-star"></i></li>
                          <li><i class="far fa-star"></i></li>
                        </ul>
                        <span>(26)</span>
                      </div>
                      <h3 class="weekly-product__title">
                        Brendy Bluest Headphone
                      </h3>
                      <h3 class="weekly-product__price ul_li mb-15">
                        <span class="new">$16.00</span
                        ><span class="old">$32.00</span
                        ><span class="off">-34%</span>
                      </h3>

                      <h4 class="weekly-product__deal">Deals End To:</h4>

                      <div
                        class="countdown style-2 ul_li mt-15 d-flex flex-row justify-content-start align-items-start"
                        data-countdown="2024/08/28"
                      ></div>
                    </div>

                    <div class="tab-content" id="wpTabContent">
                      <div
                        class="tab-pane fade show active"
                        id="wp-tab-1"
                        role="tabpanel"
                        aria-labelledby="wp-tab-01"
                      >
                        <div class="weekly-product__img">
                          <img src="assets/img/product/img_82.png" alt="" />
                        </div>
                      </div>
                      <div
                        class="tab-pane fade"
                        id="wp-tab-2"
                        role="tabpanel"
                        aria-labelledby="wp-tab-02"
                      >
                        <div class="weekly-product__img">
                          <img src="assets/img/product/img_82.png" alt="" />
                        </div>
                      </div>
                      <div
                        class="tab-pane fade"
                        id="wp-tab-3"
                        role="tabpanel"
                        aria-labelledby="wp-tab-03"
                      >
                        <div class="weekly-product__img">
                          <img src="assets/img/product/img_82.png" alt="" />
                        </div>
                      </div>
                      <div
                        class="tab-pane fade"
                        id="wp-tab-4"
                        role="tabpanel"
                        aria-labelledby="wp-tab-04"
                      >
                        <div class="weekly-product__img">
                          <img src="assets/img/product/img_82.png" alt="" />
                        </div>
                      </div>
                    </div>
                  </div>
                  <ul
                    class="weekly-product__nav nav nav-tabs mt-5"
                    id="wpTab"
                    role="tablist"
                  >
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link active"
                        id="wp-tab-01"
                        data-bs-toggle="tab"
                        data-bs-target="#wp-tab-1"
                        type="button"
                        role="tab"
                        aria-controls="wp-tab-1"
                        aria-selected="true"
                      >
                        <span class="weekly-product__nav-img">
                          <img src="assets/img/product/img_83.png" alt="" />
                        </span>
                      </button>
                    </li>
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link"
                        id="wp-tab-02"
                        data-bs-toggle="tab"
                        data-bs-target="#wp-tab-2"
                        type="button"
                        role="tab"
                        aria-controls="wp-tab-2"
                        aria-selected="false"
                      >
                        <span class="weekly-product__nav-img">
                          <img src="assets/img/product/img_84.png" alt="" />
                        </span>
                      </button>
                    </li>
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link"
                        id="wp-tab-03"
                        data-bs-toggle="tab"
                        data-bs-target="#wp-tab-3"
                        type="button"
                        role="tab"
                        aria-controls="wp-tab-3"
                        aria-selected="false"
                      >
                        <span class="weekly-product__nav-img">
                          <img src="assets/img/product/img_85.png" alt="" />
                        </span>
                      </button>
                    </li>
                  </ul>
                </div>
              </div>

              <div class="col-lg-3 mt-30">
                <div class="rd-side__product">
                  <div class="tab-content" id="rdSideImag">
                    <div
                      class="tab-pane fade show active"
                      id="rds-01"
                      role="tabpanel"
                      aria-labelledby="rds-tab-01"
                    >
                      <div class="rd-side__img">
                        <img src="assets/img/product/img_88.png" alt="" />
                      </div>
                    </div>
                    <div
                      class="tab-pane fade"
                      id="rds-02"
                      role="tabpanel"
                      aria-labelledby="rds-tab-02"
                    >
                      <div class="rd-side__img">
                        <img src="assets/img/product/img_88.png" alt="" />
                      </div>
                    </div>
                    <div
                      class="tab-pane fade"
                      id="rds-03"
                      role="tabpanel"
                      aria-labelledby="rds-tab-03"
                    >
                      <div class="rd-side__img">
                        <img src="assets/img/product/img_88.png" alt="" />
                      </div>
                    </div>
                  </div>
                  <ul
                    class="nav nav-tabs rd-side__nav"
                    id="rdSideNav"
                    role="tablist"
                  >
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link active"
                        id="rds-tab-01"
                        data-bs-toggle="tab"
                        data-bs-target="#rds-01"
                        type="button"
                        role="tab"
                        aria-controls="rds-01"
                        aria-selected="true"
                      >
                        <img src="assets/img/product/img_89.png" alt="" />
                      </button>
                    </li>
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link"
                        id="rds-tab-02"
                        data-bs-toggle="tab"
                        data-bs-target="#rds-02"
                        type="button"
                        role="tab"
                        aria-controls="rds-02"
                        aria-selected="false"
                      >
                        <img src="assets/img/product/img_90.png" alt="" />
                      </button>
                    </li>
                    <li class="nav-item" role="presentation">
                      <button
                        class="nav-link"
                        id="rds-tab-03"
                        data-bs-toggle="tab"
                        data-bs-target="#rds-03"
                        type="button"
                        role="tab"
                        aria-controls="rds-03"
                        aria-selected="false"
                      >
                        <img src="assets/img/product/img_91.png" alt="" />
                      </button>
                    </li>
                  </ul>

                  <h2 class="title">
                    <a href="#!">Amazon Cloud Cam Security</a>
                  </h2>
                  <div class="product__review ul_li">
                    <ul class="rating-star ul_li mr-10">
                      <li><i class="fas fa-star"></i></li>
                      <li><i class="fas fa-star"></i></li>
                      <li><i class="fas fa-star"></i></li>
                      <li><i class="far fa-star"></i></li>
                      <li><i class="far fa-star"></i></li>
                    </ul>
                    <span>(26)</span>
                  </div>
                  <h4 class="product__price">
                    <span class="new">$30.52</span
                    ><span class="old">$28.52</span
                    ><span class="off">-34%</span>
                  </h4>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", async () => {
            let deals;
            try {
              const res = await fetch("/flashsalesmaindata");
              deals = await res.json();
            } catch (err) {
              console.error("Failed to load flash sales:", err);
              return;
            }

            const today = new Date().toISOString().slice(0, 10);
            const valid = deals.filter(
              (d) => d.status === "Published" && d.end_date >= today
            );

            const section = document.querySelector(".pt-30");
            if (valid.length === 0) {
              section.innerHTML = `
                <div class="container mxw_1530 text-center py-5">
                  <h2 class="section-heading mb-4">
                    <span><span>Deals</span> Of The Day</span>
                  </h2>
                  <h3>No deals available at this time.</h3>
                </div>`;
              return;
            }

            const mainDeals = valid.slice(0, 4);
            const sideDeals = valid.slice(0, 3);

            (function fillBanner(d) {
              const banner = document.querySelector(".add-banner__3");
              if (!banner) return;

              const h3 = banner.querySelector(".add-banner__content h3");
              h3.innerHTML = d.product_name.replace(/<br\s*\/?>/i, "<br/>");

              const saveSpan = banner.querySelector(
                ".add-banner__content span"
              );
              const p = parseFloat(d.price.replace("$", "")) || 0;
              const s = parseFloat(d.price_sale.replace("$", "")) || 0;
              const pct = p > 0 ? Math.round(((p - s) / p) * 100) : 0;
              saveSpan.textContent = `Get Save ${pct}% off`;

              const shopLink = banner.querySelector(
                ".add-banner__content a.thm-btn"
              );
              if (shopLink)
                shopLink.href = `shop-single.html?id=${d.product_id}`;

              const img = banner.querySelector(".add-banner__img img");
              if (img) img.src = `/uploads/${d.image}`;
            })(mainDeals[0]);

            mainDeals.forEach((d, i) => {
              const paneImg = document.querySelector(`#wp-tab-${i + 1} img`);
              const thumb = document.querySelector(
                `#wp-tab-0${i + 1} .weekly-product__nav-img img`
              );
              if (paneImg) paneImg.src = `/uploads/${d.image}`;
              if (thumb) thumb.src = `/uploads/${d.image}`;
            });

            sideDeals.forEach((d, i) => {
              const paneImg = document.querySelector(`#rds-0${i + 1} img`);
              const thumb = document.querySelector(`#rds-tab-0${i + 1} img`);
              if (paneImg) paneImg.src = `/uploads/${d.image}`;
              if (thumb) thumb.src = `/uploads/${d.image}`;
            });

            document
              .querySelectorAll("#rdSideNav button.nav-link")
              .forEach((btn, idx) => {
                btn.addEventListener("click", () => {
                  const d = sideDeals[idx];
                  if (!d) return;

                  const sideTitle = document.querySelector(
                    ".rd-side__product .title a"
                  );
                  sideTitle.textContent = d.product_name;

                  const priceEl = document.querySelector(
                    ".rd-side__product .product__price"
                  );
                  priceEl.querySelector(".new").textContent = d.price;
                  priceEl.querySelector(".old").textContent = d.price_sale;
                  let offEl = priceEl.querySelector(".off");
                  if (!offEl) {
                    offEl = document.createElement("span");
                    offEl.className = "off";
                    priceEl.append(offEl);
                  }
                  const pNum = parseFloat(d.price.replace("$", "")) || 0;
                  const sNum = parseFloat(d.price_sale.replace("$", "")) || 0;
                  offEl.textContent =
                    pNum > 0
                      ? `-${Math.round(((pNum - sNum) / pNum) * 100)}%`
                      : "";
                });
              });
            document.querySelector("#rds-tab-01").click();

            document
              .querySelectorAll("#wpTab button.nav-link")
              .forEach((btn, idx) => {
                btn.addEventListener("click", () => {
                  const d = mainDeals[idx];
                  if (!d) return;

                  document.querySelector(".weekly-product__title").textContent =
                    d.product_name;

                  const priceEl = document.querySelector(
                    ".weekly-product__price"
                  );
                  priceEl.querySelector(".new").textContent = d.price;
                  priceEl.querySelector(".old").textContent = d.price_sale;
                  priceEl.querySelector(".off").textContent = (() => {
                    const p = parseFloat(d.price.replace("$", "")) || 0;
                    const s = parseFloat(d.price_sale.replace("$", "")) || 0;
                    return p > 0 ? `-${Math.round(((p - s) / p) * 100)}%` : "";
                  })();

                  setupCountdown(d.end_date);
                });
              });
            document.querySelector("#wp-tab-01").click();

            function setupCountdown(endDateStr) {
              const cdEl = document.querySelector(".countdown.style-2");
              if (!cdEl) return;

              if (!cdEl.dataset.initialized) {
                const units = [
                  { key: "days", label: "DAYS" },
                  { key: "hours", label: "HOURS" },
                  { key: "mins", label: "MINS" },
                  { key: "secs", label: "SEC" },
                ];
                cdEl.innerHTML = units
                  .map(
                    (u) => `
                  <div class="time-box">
                    <span class="time" data-unit="${u.key}">00</span>
                    <span class="label">${u.label}</span>
                  </div>
                `
                  )
                  .join("");
                cdEl.dataset.initialized = "true";
              }

              if (cdEl._intv) clearInterval(cdEl._intv);

              function update() {
                const now = new Date();
                const end = new Date(endDateStr + "T23:59:59");
                let diff = Math.max(0, end - now);

                const days = Math.floor(diff / 864e5);
                diff %= 864e5;
                const hours = Math.floor(diff / 36e5);
                diff %= 36e5;
                const mins = Math.floor(diff / 6e4);
                diff %= 6e4;
                const secs = Math.floor(diff / 1000);

                cdEl.querySelector('[data-unit="days"]').textContent = String(
                  days
                ).padStart(2, "0");
                cdEl.querySelector('[data-unit="hours"]').textContent = String(
                  hours
                ).padStart(2, "0");
                cdEl.querySelector('[data-unit="mins"]').textContent = String(
                  mins
                ).padStart(2, "0");
                cdEl.querySelector('[data-unit="secs"]').textContent = String(
                  secs
                ).padStart(2, "0");
              }

              update();
              cdEl._intv = setInterval(update, 1000);
            }
          });
        </script>

        <div class="rd-product__bg pt-30">
          <div class="container mxw_1530">
            <div class="rd-product__slide-wrap">
              <h2 class="section-heading mb-30 ul_li_between">
                <span>Tructor Parts</span>
                <span><span>Baby Items</span> / Gift Item </span>
              </h2>
              <div
                class="rd-product__slide-two"
                id="tractor-products-container"
              ></div>
            </div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", () => {
            const container = document.getElementById(
              "tractor-products-container"
            );
            const lightbox = document.getElementById("image-lightbox");
            const lightboxImg = document.getElementById("lightbox-image");
            const counterEl = document.getElementById("lightbox-counter");
            const lightboxClose = document.getElementById("lightbox-close");
            const lightboxPrev = document.getElementById("lightbox-prev");
            const lightboxNext = document.getElementById("lightbox-next");

            let allImages = [];
            let currentIndex = 0;

            fetch("/productpagedata")
              .then((res) => res.json())
              .then((products) => {
                const tructorParts = products.filter(
                  (p) => p.category === "Tructor Parts"
                );
                products.sort((a, b) => new Date(b.date) - new Date(a.date));
                const displayProducts =
                  tructorParts.length > 0
                    ? tructorParts.slice(0, 6)
                    : products.slice(0, 6);

                allImages = products.map((p) => `/uploads/${p.image}`);

                const productHTML = displayProducts
                  .map((product) => {
                    const imageIndex = allImages.indexOf(
                      `/uploads/${product.image}`
                    );
                    return `
                      <div class="tab-product__item tx-product text-center">
                        <div class="thumb">
                          <a href="#">
                            <img src="/uploads/${product.image}" alt="${
                      product.name
                    }" />
                          </a>
                          <ul class="product__action style-2 ul_li">
                            <li>
                              <a href="#" class="img-popup icon-btn" data-index="${imageIndex}">
                                <i class="far fa-compress-alt"></i>
                              </a>
                            </li>
                            <li>
                              <a href="#" class="add-to-cart icon-btn"
                                data-id="${product.id}"
                                data-name="${product.name}"
                                data-store="${product.store}"
                                data-price="${product.price.replace(
                                  /[^0-9.]/g,
                                  ""
                                )}"
                                data-price_sale="${product.price_sale.replace(
                                  /[^0-9.]/g,
                                  ""
                                )}"
                                data-image="${product.image}">
                                <i class="far fa-shopping-basket"></i>
                              </a>
                            </li>
                            <li>
                              <a href="#" class="add-to-wishlist icon-btn"
                                data-id="${product.id}"
                                data-name="${product.name}"
                                data-store="${product.store}"
                                data-price="${product.price.replace(
                                  /[^0-9.]/g,
                                  ""
                                )}"
                                data-price_sale="${product.price_sale.replace(
                                  /[^0-9.]/g,
                                  ""
                                )}"
                                data-image="${product.image}"
                                data-sku="${product.sku}"
                                data-stockstatus="${product.stockstatus}">
                                <i class="far fa-heart"></i>
                              </a>
                            </li>
                          </ul>
                        </div>
                        <div class="content">
                          <div class="product__review ul_li_center">
                            <ul class="rating-star ul_li mr-10">
                              <li><i class="fas fa-star"></i></li>
                              <li><i class="fas fa-star"></i></li>
                              <li><i class="fas fa-star"></i></li>
                              <li><i class="far fa-star"></i></li>
                              <li><i class="far fa-star"></i></li>
                            </ul>
                            <span>(${Math.floor(Math.random() * 100)})</span>
                          </div>
                          <h3 class="title"><a href="shop-single.html?id=${
                            product.id
                          }">${product.name}</a></h3>
                          <h3 class="title d-none"><a href="#">${
                            product.store
                          }</a></h3>
                          <h3 class="title d-none"><a href="#">${
                            product.sku
                          }</a></h3>
                          <h3 class="title d-none"><a href="#">${
                            product.stockstatus
                          }</a></h3>
                          <span class="price">
                            ( ${product.price} - <span class="old-price">${
                      product.price_sale
                    }</span> )
                          </span>
                        </div>
                        <span class="badge-skew">${
                          product.label || "New"
                        }</span>
                      </div>
                    `;
                  })
                  .join("");

                container.innerHTML = productHTML;

                container.querySelectorAll(".img-popup").forEach((link) => {
                  link.addEventListener("click", (e) => {
                    e.preventDefault();
                    currentIndex = parseInt(link.dataset.index);
                    openLightbox(allImages[currentIndex]);
                  });
                });
              })
              .catch((err) => {
                console.error("Error loading products:", err);
                container.innerHTML = "<p>Error loading products.</p>";
              });

            function openLightbox(src) {
              lightboxImg.src = src;
              counterEl.textContent = `${currentIndex + 1} of ${
                allImages.length
              }`;
              lightbox.style.display = "flex";
            }

            lightboxClose.addEventListener("click", () => {
              lightbox.style.display = "none";
            });

            lightboxNext.addEventListener("click", () => {
              currentIndex = (currentIndex + 1) % allImages.length;
              openLightbox(allImages[currentIndex]);
            });

            lightboxPrev.addEventListener("click", () => {
              currentIndex =
                (currentIndex - 1 + allImages.length) % allImages.length;
              openLightbox(allImages[currentIndex]);
            });
          });
        </script>

        <div class="newslater gray-bg pt-55 pb-60">
          <div class="container mxw_1530">
            <div class="newslater__three ul_li">
              <div class="newslater__content">
                <h2 class="title">Join Our <span>Newsletter</span></h2>
                <p>Sale up to 20% off for your next purchase in this month</p>
              </div>
              <form class="newslater__form js-newsletter-form" action="#!">
                <input
                  placeholder="Enter Your Email Address"
                  name="email"
                  type="email"
                  required
                />
                <button class="thm-btn" type="submit">
                  <span class="btn-wrap">
                    <span>Subscribe Now</span>
                    <span>Subscribe Now</span>
                  </span>
                </button>
              </form>
            </div>
          </div>
        </div>

        <div class="rd-parts pt-60">
          <div class="container mxw_1530">
            <div class="row mt-none-30">
              <div class="col-lg-3 mt-30">
                <div class="product-category product-category__two mr-60">
                  <h2 class="section-heading mb-40">
                    <span><span>Catagory</span></span>
                  </h2>
                  <ul class="list-unstyled"></ul>
                </div>
              </div>

              <div class="col-lg-9 mt-30">
                <div class="rd-parts__wrap">
                  <div class="rd-products__nav ul_li_between mb-20">
                    <h2 class="section-heading">
                      <span>Motorbike parts <span>(new)</span></span>
                    </h2>
                    <ul
                      class="nav nav-tabs brand-filter"
                      id="rdpTab"
                      role="tablist"
                    >
                      <li class="nav-item" role="presentation">
                        <button
                          class="nav-link"
                          id="rdp-tab-01"
                          data-bs-toggle="tab"
                          data-bs-target="#rdp-tab1"
                          role="tabpanel"
                          type="button"
                          aria-controls="rdp-tab1"
                          aria-selected="true"
                        >
                          Engine
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button
                          class="nav-link"
                          id="rdp-tab-02"
                          data-bs-toggle="tab"
                          data-bs-target="#rdp-tab2"
                          type="button"
                          role="tabpanel"
                          aria-controls="rdp-tab2"
                          aria-selected="false"
                        >
                          Transmission
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button
                          class="nav-link"
                          id="rdp-tab-03"
                          data-bs-toggle="tab"
                          data-bs-target="#rdp-tab3"
                          type="button"
                          role="tabpanel"
                          aria-controls="rdp-tab3"
                          aria-selected="false"
                        >
                          Battery
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button
                          class="nav-link active"
                          id="rdp-tab-04"
                          data-bs-toggle="tab"
                          data-bs-target="#rdp-tab4"
                          type="button"
                          role="tabpanel"
                          aria-controls="rdp-tab4"
                          aria-selected="false"
                        >
                          Radiator
                        </button>
                      </li>
                      <li class="nav-item" role="presentation">
                        <button
                          class="nav-link"
                          id="rdp-tab-05"
                          data-bs-toggle="tab"
                          data-bs-target="#rdp-tab5"
                          type="button"
                          role="tabpanel"
                          aria-controls="rdp-tab5"
                          aria-selected="false"
                        >
                          Fuel Tank
                        </button>
                      </li>
                    </ul>
                  </div>

                  <div class="rd-parts__products">
                    <div class="tab-content" id="rdpTabContent">
                      <div
                        class="tab-pane animated fadeInUp"
                        id="rdp-tab1"
                        role="tabpanel"
                        aria-labelledby="rdp-tab-01"
                      >
                        <div class="row g-0 mt-none-30"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="rdp-tab2"
                        role="tabpanel"
                        aria-labelledby="rdp-tab-02"
                      >
                        <div class="row g-0 mt-none-30"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="rdp-tab3"
                        role="tabpanel"
                        aria-labelledby="rdp-tab-03"
                      >
                        <div class="row g-0 mt-none-30"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp show active"
                        id="rdp-tab4"
                        role="tabpanel"
                        aria-labelledby="rdp-tab-04"
                      >
                        <div class="row g-0 mt-none-30"></div>
                      </div>

                      <div
                        class="tab-pane animated fadeInUp"
                        id="rdp-tab5"
                        role="tabpanel"
                        aria-labelledby="rdp-tab-05"
                      >
                        <div class="row g-0 mt-none-30"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", async () => {
            const lightbox = document.getElementById("image-lightbox");
            const lightboxImg = document.getElementById("lightbox-image");
            const counterEl = document.getElementById("lightbox-counter");
            const lightboxClose = document.getElementById("lightbox-close");
            const lightboxPrev = document.getElementById("lightbox-prev");
            const lightboxNext = document.getElementById("lightbox-next");

            let allProducts = [];
            let currentIndex = 0;
            let currentImages = [];

            const attributeMap = {
              "#rdp-tab1": "Engine",
              "#rdp-tab2": "Transmission",
              "#rdp-tab3": "Battery",
              "#rdp-tab4": "Radiator",
              "#rdp-tab5": "Fuel Tank",
            };

            async function loadProducts() {
              try {
                const res = await fetch("/productpagedata");
                if (!res.ok) throw new Error(res.statusText);
                const data = await res.json();
                if (!Array.isArray(data)) throw new Error("Invalid JSON");

                allProducts = data
                  .filter((p) => ["Published", "Draft"].includes(p.status))
                  .sort((a, b) => new Date(b.date) - new Date(a.date));

                renderProducts("#rdp-tab4");
              } catch (err) {
                console.error("Error loading products:", err);
              }
            }

            function renderProducts(tabSelector) {
              const tab = document.querySelector(tabSelector);
              if (!tab) return;
              const container = tab.querySelector(".row");
              if (!container) return;

              const attrName = attributeMap[tabSelector];
              const filtered = allProducts
                .filter(
                  (p) =>
                    p.attribute &&
                    p.attribute.toLowerCase().includes(attrName.toLowerCase())
                )
                .slice(0, 8);

              container.innerHTML = "";
              if (filtered.length === 0) {
                container.innerHTML = `
                  <div class="col-12 text-center mt-30">
                    <p class="text-danger fw-bold">
                      No “${attrName}” products available.
                    </p>
                  </div>`;
                currentImages = [];
                return;
              }

              currentImages = filtered.map((p) => `/uploads/${p.image}`);

              filtered.forEach((p, i) => {
                container.insertAdjacentHTML(
                  "beforeend",
                  `
                  <div class="col-1-of-5 mt-30">
                    <div class="product__item style-3">
                      <div class="product__img text-center pos-rel">
                        <a href="shop-single.html">
                          <img src="/uploads/${p.image}" alt="${p.name}" />
                        </a>
                        <ul class="product__action style-2 ul_li">
                          <li>
                            <a href="/uploads/${p.image}"
                               class="img-popup icon-btn"
                               data-index="${i}">
                              <i class="far fa-compress-alt"></i>
                            </a>
                          </li>
                          <li>
                            <a href="#" class="add-to-cart icon-btn"
                               data-id="${p.id}"
                               data-name="${p.name}"
                               data-store="${p.store}"
                               data-price="${p.price.replace(/[^0-9.]/g, "")}"
                               data-price_sale="${p.price_sale.replace(
                                 /[^0-9.]/g,
                                 ""
                               )}"
                               data-image="${p.image}">
                              <i class="far fa-shopping-basket"></i>
                            </a>
                          </li>
                          <li>
                            <a href="#" class="add-to-wishlist icon-btn"
                               data-id="${p.id}"
                               data-name="${p.name}"
                               data-store="${p.store}"
                               data-price="${p.price.replace(/[^0-9.]/g, "")}"
                               data-price_sale="${p.price_sale.replace(
                                 /[^0-9.]/g,
                                 ""
                               )}"
                               data-image="${p.image}"
                               data-sku="${p.sku}"
                               data-stockstatus="${p.stockstatus}">
                              <i class="far fa-heart"></i>
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="product__content">
                        <div class="product__review ul_li_center">
                          <ul class="rating-star ul_li mr-10">
                            <li><i class="fas fa-star"></i></li>
                            <li><i class="fas fa-star"></i></li>
                            <li><i class="fas fa-star"></i></li>
                            <li><i class="far fa-star"></i></li>
                            <li><i class="far fa-star"></i></li>
                          </ul>
                          <span>(${Math.floor(Math.random() * 100)})</span>
                        </div>
                        <h2 class="product__title text-center">
                          <a href="shop-single.html">${p.name}</a>
                        </h2>
                        <h4 class="product__price text-center">
                          <span class="new">${p.price}</span>
                          <span class="old">${p.price_sale}</span>
                        </h4>
                      </div>
                      <span class="badge-skew">${p.label}</span>
                    </div>
                  </div>
                `
                );
              });

              tab.querySelectorAll(".img-popup").forEach((link) => {
                link.addEventListener("click", (e) => {
                  e.preventDefault();
                  currentIndex = +link.dataset.index;
                  openLightbox(currentImages[currentIndex]);
                });
              });
            }

            function openLightbox(src) {
              lightboxImg.src = src;
              counterEl.textContent = `${currentIndex + 1} of ${
                currentImages.length
              }`;
              lightbox.style.display = "flex";
            }

            lightboxClose.addEventListener("click", () => {
              lightbox.style.display = "none";
            });
            lightboxNext.addEventListener("click", () => {
              if (currentIndex < currentImages.length - 1) {
                currentIndex++;
                openLightbox(currentImages[currentIndex]);
              }
            });
            lightboxPrev.addEventListener("click", () => {
              if (currentIndex > 0) {
                currentIndex--;
                openLightbox(currentImages[currentIndex]);
              }
            });

            Object.keys(attributeMap).forEach((tabSel) => {
              const btn = document.querySelector(
                `[data-bs-target="${tabSel}"]`
              );
              if (btn) {
                btn.addEventListener("shown.bs.tab", () => {
                  renderProducts(tabSel);
                });
              }
            });

            await loadProducts();
          });
        </script>

        <div
          id="image-lightbox"
          style="
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
          "
        >
          <div
            style="
              position: relative;
              display: flex;
              align-items: center;
              justify-content: center;
              width: 100%;
              height: 100%;
            "
          >
            <button
              id="lightbox-prev"
              style="
                position: absolute;
                left: 20px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 22px;
                color: white;
                background: none;
                border: none;
                cursor: pointer;
              "
            >
              <i class="fas fa-play" style="transform: rotate(180deg)"></i>
            </button>

            <div style="position: relative; display: inline-block">
              <img
                id="lightbox-image"
                src=""
                alt="Product"
                style="
                  width: 336px;
                  height: 400px;
                  object-fit: contain;
                  border-radius: 4px;
                "
              />

              <div
                id="lightbox-counter"
                style="
                  position: absolute;
                  bottom: 0px;
                  right: -2px;
                  color: #fff;
                  padding: 4px 8px;
                  border-radius: 12px;
                  font-size: 14px;
                "
              >
                1 of 0
              </div>

              <button
                id="lightbox-close"
                style="
                  position: absolute;
                  top: 0;
                  right: -8px;
                  font-size: 30px;
                  color: white;
                  background: none;
                  border: none;
                  border-radius: 50%;
                  width: 32px;
                  height: 32px;
                  cursor: pointer;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  padding: 0;
                  z-index: 10;
                "
              >
                ×
              </button>
            </div>

            <button
              id="lightbox-next"
              style="
                position: absolute;
                right: 20px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 22px;
                color: white;
                background: none;
                border: none;
                cursor: pointer;
              "
            >
              <i class="fas fa-play"></i>
            </button>
          </div>
        </div>

        <div class="rd-product-category pt-50">
          <div class="container mxw_1530">
            <h2 class="section-heading mb-25">
              <span>Product Catagories</span>
            </h2>
            <div class="row mt-none-30">
              <div class="col-lg-9 mt-30">
                <div class="rd-product-category__wrap">
                  <div class="row mt-none-50">
                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_102.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_103.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>

                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home"
                                type="button"
                                role="tab"
                                aria-controls="fc-home"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_102.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_103.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>

                        <div class="product-cat__content mt-20">
                          <h3 class="title">welding stud welding</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>

                        <span class="product-cat__number">01</span>
                      </div>
                    </div>

                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent2">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home2"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab2"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_103.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile2"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab2"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_104.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>
                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab2"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab2"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home2"
                                type="button"
                                role="tab"
                                aria-controls="fc-home2"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_103.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab2"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile2"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile2"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_104.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>
                        <div class="product-cat__content mt-20">
                          <h3 class="title">car automotive engine</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>
                        <span class="product-cat__number">02</span>
                      </div>
                    </div>

                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent3">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home3"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab3"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_104.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile3"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab3"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_105.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>
                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab3"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab3"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home3"
                                type="button"
                                role="tab"
                                aria-controls="fc-home3"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_104.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab3"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile3"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile3"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_105.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>
                        <div class="product-cat__content mt-20">
                          <h3 class="title">engines muffler two</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>
                        <span class="product-cat__number">03</span>
                      </div>
                    </div>

                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent4">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home4"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab4"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_105.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile4"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab4"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_106.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>
                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab4"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab4"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home4"
                                type="button"
                                role="tab"
                                aria-controls="fc-home4"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_105.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab4"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile4"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile4"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_106.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>
                        <div class="product-cat__content mt-20">
                          <h3 class="title">air suspension car</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>
                        <span class="product-cat__number">04</span>
                      </div>
                    </div>

                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent5">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home5"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab5"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_106.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile5"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab5"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_107.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>
                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab5"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab5"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home5"
                                type="button"
                                role="tab"
                                aria-controls="fc-home5"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_106.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab5"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile5"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile5"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_107.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>
                        <div class="product-cat__content mt-20">
                          <h3 class="title">brake pad wheel</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>
                        <span class="product-cat__number">05</span>
                      </div>
                    </div>

                    <div class="col-lg-4 col-md-4">
                      <div
                        class="product-cat__item product-cat__item-two pos-rel mt-40"
                      >
                        <div class="product-cat__images mt-20">
                          <div class="tab-content" id="fc-myTabContent6">
                            <div
                              class="tab-pane fade show active"
                              id="fc-home6"
                              role="tabpanel"
                              aria-labelledby="fc-home-tab6"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_107.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                            <div
                              class="tab-pane fade"
                              id="fc-profile6"
                              role="tabpanel"
                              aria-labelledby="fc-profile-tab6"
                            >
                              <div class="product-cat__img">
                                <a href="shop-single.html"
                                  ><img
                                    src="assets/img/product/img_103.png"
                                    alt=""
                                /></a>
                              </div>
                            </div>
                          </div>
                          <ul
                            class="nav product-cat__nav product-cat__nav-two nav-tabs"
                            id="fc-myTab6"
                            role="tablist"
                          >
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link active"
                                id="fc-home-tab6"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-home6"
                                type="button"
                                role="tab"
                                aria-controls="fc-home6"
                                aria-selected="true"
                              >
                                <img
                                  src="assets/img/product/img_107.png"
                                  alt=""
                                />
                              </button>
                            </li>
                            <li class="nav-item" role="presentation">
                              <button
                                class="nav-link"
                                id="fc-profile-tab6"
                                data-bs-toggle="tab"
                                data-bs-target="#fc-profile6"
                                type="button"
                                role="tab"
                                aria-controls="fc-profile6"
                                aria-selected="false"
                              >
                                <img
                                  src="assets/img/product/img_103.png"
                                  alt=""
                                />
                              </button>
                            </li>
                          </ul>
                        </div>
                        <div class="product-cat__content mt-20">
                          <h3 class="title">Smartphone & Tablet</h3>
                          <ul class="list-unstyled">
                            <li><a href="#!">Bluetooth speaker</a></li>
                            <li><a href="#!">Robotics vacuum</a></li>
                            <li><a href="#!">Laser printer</a></li>
                            <li><a href="#!">Electric frying pan</a></li>
                          </ul>
                        </div>
                        <span class="product-cat__number">06</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-3 mt-30">
                <div class="add-banner__wrap ml-70">
                  <div
                    class="add-banner add-banner__4 add-banner__h530 bg_img text-center"
                    data-background="assets/img/bg/bg_16.jpg"
                  >
                    <span>Get Save 30% off</span>
                    <h3 class="text-capitalize">
                      general motors buick <br />
                      sonic engine
                    </h3>
                    <span class="price">$ 18560.99</span>
                    <a class="thm-btn mt-40" href="shop.html">
                      <span class="btn-wrap">
                        <span>Shop Now</span>
                        <span>Shop Now</span>
                      </span>
                      <i class="far fa-long-arrow-right"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="banner pt-50">
          <div class="container mxw_1530">
            <div
              class="banner__wrap bg_img ul_li"
              data-background="assets/img/bg/bg_17.jpg"
            >
              <div class="banner__content">
                <span>Expert mechanic</span>
                <h3>
                  Repair Car Perfectly <br />
                  From Expertist
                </h3>
                <p>Sumptuous, filling, and temptingly healthy.</p>
                <a class="hero__btn" href="#!"
                  >Make enquiry <i class="far fa-long-arrow-right"></i
                ></a>
              </div>
              <div class="banner__ofer-box">
                <img src="assets/img/icon/offer_bg.png" alt="" />
                <span class="offer-text"
                  >30% <br />
                  <span>OFF</span></span
                >
              </div>
              <div class="banner-img">
                <img src="assets/img/product/img_108.png" alt="" />
              </div>
              <div class="banner-offer-text">
                <img src="assets/img/icon/offer_text.png" alt="" />
              </div>
            </div>
          </div>
        </div>

        <div class="pt-55">
          <div class="container mxw_1530">
            <div class="row mt-none-30">
              <div class="col-lg-10">
                <div class="rd-category__left">
                  <div class="row">
                    <div class="col-lg-3 col-md-6 tab-product-col mt-30">
                      <div
                        class="product-category product-category__2 bg_img"
                        data-background="assets/img/bg/cat_bg.jpg"
                      >
                        <h2 class="product-category__title">Choose Catagory</h2>
                        <ul class="list-unstyled"></ul>
                      </div>
                    </div>

                    <div class="col-lg-3 col-md-6 tab-product-col mt-30">
                      <h2 class="section-heading mb-20 fs-18">
                        <span>Top Rated</span>
                      </h2>
                      <div
                        class="tx-widget__product-slide tx-arrow top-rated-products"
                      ></div>
                    </div>

                    <div class="col-lg-3 col-md-6 tab-product-col mt-30">
                      <h2 class="section-heading mb-20 fs-18">
                        <span>Hot Product</span>
                      </h2>
                      <div
                        class="tx-widget__product-slide tx-arrow hot-product-products"
                      ></div>
                    </div>

                    <div class="col-lg-3 col-md-6 tab-product-col mt-30">
                      <h2 class="section-heading mb-20 fs-18">
                        <span>Latest Item</span>
                      </h2>
                      <div
                        class="tx-widget__product-slide tx-arrow latest-item-products"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>

              <script>
                document.addEventListener("DOMContentLoaded", function () {
                  fetch("/productpagedata")
                    .then((res) => res.json())
                    .then((data) => {
                      const topRated = data
                        .filter((p) => p.label === "New")
                        .slice(0, 4);
                      const hotProduct = data
                        .filter((p) => p.label === "Hot")
                        .slice(0, 4);
                      const latestItem = data
                        .filter((p) => p.label === "New")
                        .sort((a, b) => new Date(b.date) - new Date(a.date))
                        .slice(0, 4);

                      const createProductHTML = (product) => {
                        return `
                          <div class="tx-widget__product-item style-2 tx-product ul_li">
                            <div class="thumb">
                              <a href="#">
                                <img src="/uploads/${product.image}" alt="${product.name}" class="border"/>
                              </a>
                            </div>
                            <div class="content">
                              <h3>
                                <a href="shop-single.html?id=${product.id}">${product.name}</a>
                              </h3>
                              <h4 class="product__price">
                                <span class="new">${product.price}</span>
                                <span class="old">${product.price_sale}</span>
                              </h4>
                            </div>
                          </div>
                        `;
                      };

                      const insertProducts = (containerSelector, products) => {
                        const container =
                          document.querySelector(containerSelector);
                        if (!container) return;

                        container.innerHTML = `
                          <div class="tx-widget__product-single">
                            ${products.map(createProductHTML).join("")}
                          </div>
                        `;
                      };

                      insertProducts(".top-rated-products", topRated);
                      insertProducts(".hot-product-products", hotProduct);
                      insertProducts(".latest-item-products", latestItem);
                    })
                    .catch((err) =>
                      console.error("Failed to load product data:", err)
                    );
                });
              </script>

              <div class="col-lg-2 mt-30">
                <div class="add-banner__wrap ml-none-70">
                  <div
                    class="add-banner add-banner__4 add-banner__h476 br-5 bg_img text-center"
                    data-background="assets/img/bg/bg_18.jpg"
                  >
                    <span>Get Save 30% off</span>
                    <h3 class="text-capitalize">
                      Cloud Cam, <br />
                      Security Camera
                    </h3>
                    <span class="price">$ 18560.99</span>
                    <a class="thm-btn mt-40" href="shop.html">
                      <span class="btn-wrap">
                        <span>Shop Now</span>
                        <span>Shop Now</span>
                      </span>
                      <i class="far fa-long-arrow-right"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="brand pt-70 pb-90">
          <div class="container mxw_1530">
            <div class="brand__active">
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_01.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_02.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_03.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_04.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_05.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_06.png" alt="" />
                </a>
              </div>
              <div class="brand__item">
                <a href="#!">
                  <img src="assets/img/brand/img_03.png" alt="" />
                </a>
              </div>
            </div>
          </div>
        </div>
      </main>

      <script>
        document.addEventListener("DOMContentLoaded", async () => {
          try {
            const res = await fetch("/productcatdata");
            if (!res.ok)
              throw new Error(`Failed to load categories: HTTP ${res.status}`);
            const cats = await res.json();
            if (!Array.isArray(cats))
              throw new Error("Category data is not an array");

            const sidebarUl = document.querySelector(
              ".product-category__two ul"
            );
            if (sidebarUl) {
              sidebarUl.innerHTML = "";
              cats.slice(0, 9).forEach((cat) => {
                const li = document.createElement("li");
                if (cat.parent) li.classList.add("cat-item-has-children");
                const a = document.createElement("a");
                a.href = cat.permalink;
                a.textContent = cat.name;
                li.appendChild(a);
                sidebarUl.appendChild(li);
              });
            }

            const featured = cats.filter(
              (c) =>
                (c.status === "Published" || c.status === "Draft") &&
                c.is_featured === "yes"
            );
            const featureItems =
              document.querySelectorAll(".product-cat__item");
            featured.slice(0, featureItems.length).forEach((cat, idx) => {
              const item = featureItems[idx];
              const imgUrl = `/uploads/${cat.image}`;
              item
                .querySelectorAll(".product-cat__images .tab-pane img")
                .forEach((img) => (img.src = imgUrl));
              item
                .querySelectorAll(".product-cat__nav img")
                .forEach((thumb) => (thumb.src = imgUrl));
              const titleEl = item.querySelector(
                ".product-cat__content .title"
              );
              if (titleEl) titleEl.textContent = cat.name;
            });

            const altUl = document.querySelector(
              ".product-category__2 ul.list-unstyled"
            );
            if (altUl) {
              altUl.innerHTML = "";
              cats.slice(0, 6).forEach((cat) => {
                const li = document.createElement("li");
                li.classList.add("cat-item-has-children");
                const a = document.createElement("a");
                a.href = "#!";
                a.textContent = cat.name;
                li.appendChild(a);
                altUl.appendChild(li);
              });
            }
          } catch (err) {
            console.error("Error in category AJAX flow:", err);
          }
        });
      </script>

      <footer class="footer footer__style-two black-bg">
        <div class="newslater newslater__border pt-30 pb-30">
          <div class="container mxw_1530">
            <div class="newslater__two ul_li">
              <div class="newslater__content">
                <h2 class="title">We are ready to <span>help</span>!</h2>
                <p>For information Consult with our expert members</p>
              </div>
              <form class="newslater__form js-newsletter-form">
                <input
                  placeholder="Enter your Email"
                  type="email"
                  name="email"
                  required
                />
                <button type="submit">Subscribe</button>
              </form>
            </div>
          </div>
        </div>

        <div class="container mxw_1530">
          <div class="footer__main pt-90 pb-90">
            <div class="row mt-none-40">
              <div class="footer__widget col-lg-3 col-md-6 mt-40">
                <div class="footer__logo mb-20">
                  <a href="index.html"
                    ><img src="assets/img/logo/logo-2.svg" alt=""
                  /></a>
                </div>
                <p>
                  4517 Washington Ave. Manchester, Kentucky 39495 Washington
                  Ave. Manchester
                </p>
                <ul class="footer__info mt-30">
                  <li>
                    <i class="far fa-map-marker-alt"></i>254 Lillian Blvd,
                    Holbrook
                  </li>
                  <li><i class="fas fa-phone"></i>1-800-654-3210</li>
                </ul>
                <div class="apps-img mt-15 ul_li">
                  <div class="app mt-15">
                    <a href="#!"
                      ><img src="assets/img/icon/google_play.png" alt=""
                    /></a>
                  </div>
                  <div class="app mt-15">
                    <a href="#!"
                      ><img src="assets/img/icon/app_store.png" alt=""
                    /></a>
                  </div>
                </div>
              </div>
              <div class="footer__widget col-lg-3 col-md-6 mt-40">
                <h2 class="title">Find It Fast</h2>
                <ul class="quick-links">
                  <li><a href="shop.html">Laptops & Computers</a></li>
                  <li><a href="shop.html">Cameras & Photography</a></li>
                  <li><a href="shop.html">Smart Phones & Tablets</a></li>
                  <li><a href="shop.html">Video Games & Consoles</a></li>
                  <li><a href="shop.html">TV & Audio</a></li>
                  <li><a href="shop.html">Gadgets</a></li>
                  <li><a href="shop.html">Waterproof Headphones</a></li>
                </ul>
              </div>

              <div class="footer__widget col-lg-3 col-md-6 mt-40">
                <h2 class="title">Quick Links</h2>
                <ul class="quick-links">
                  <li><a href="account.html">Your Account</a></li>
                  <li><a href="shop.html">Returns & Exchanges</a></li>
                  <li><a href="shop.html">Return Center</a></li>
                  <li><a href="shop.html">Purchase Hisotry</a></li>
                  <li><a href="shop.html">App Download</a></li>
                  <li><a href="news.html">Latest News Blog</a></li>
                  <li><a href="shop.html">Shipping & Delivery</a></li>
                </ul>
              </div>
              <div class="footer__widget col-lg-3 col-md-6 mt-40">
                <h2 class="title">Service us</h2>
                <ul class="category">
                  <li><a href="contact.html">Support Center</a></li>
                  <li><a href="shop.html">Term & Conditions</a></li>
                  <li><a href="shop.html">Shipping</a></li>
                  <li><a href="shop.html">Privacy Policy</a></li>
                  <li><a href="shop.html">Help</a></li>
                  <li><a href="shop.html">Products Return</a></li>
                  <li><a href="shop.html">FAQS</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="footer__bottom ul_li_center">
            <div class="footer__copyright mt-15">
              &copy; <span id="currentYear" class="text-light"></span>
              <a href="index.html">Themexriver</a> . All Rights Reserved.
            </div>

            <script>
              (function () {
                const el = document.getElementById("currentYear");
                if (el) el.textContent = new Date().getFullYear();
              })();
            </script>

            <div class="footer__social mt-15">
              <a href="https://www.facebook.com/"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a href="https://www.twitter.com/"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="https://www.instagram.com/"
                ><i class="fab fa-instagram"></i
              ></a>
              <a href="https://www.youtube.com/"
                ><i class="fab fa-youtube"></i
              ></a>
              <a href="https://www.pinterest.com/"
                ><i class="fab fa-pinterest"></i
              ></a>
            </div>

            <div class="payment_method mt-15">
              <img src="assets/img/bg/payment_method.png" alt="" />
            </div>
          </div>
        </div>
      </footer>

      <script>
        document.addEventListener("DOMContentLoaded", () => {
          function showBanner(msg, type = "success") {
            const b = document.createElement("div");
            b.textContent = msg;
            Object.assign(b.style, {
              position: "fixed",
              top: "10px",
              left: "50%",
              transform: "translateX(-50%)",
              padding: "10px 20px",
              background: type === "success" ? "#4caf50" : "#f44336",
              color: "#fff",
              borderRadius: "4px",
              zIndex: 9999,
              boxShadow: "0 2px 6px rgba(0,0,0,0.3)",
            });
            document.body.appendChild(b);
            setTimeout(() => b.remove(), 3000);
          }

          const forms = document.querySelectorAll(".js-newsletter-form");
          if (forms.length === 0) return;

          forms.forEach((form) => {
            form.addEventListener("submit", async (e) => {
              e.preventDefault();
              const input = form.querySelector('input[name="email"]');
              const email = input.value.trim();
              if (!email) {
                showBanner("Please enter a valid email.", "error");
                return;
              }

              try {
                const res = await fetch("/newsletterpost", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify({ email }),
                });
                const text = await res.text();
                if (res.ok) {
                  showBanner("Subscribed successfully!", "success");
                  form.reset();
                } else {
                  showBanner(text || "Subscription failed.", "error");
                }
              } catch (err) {
                console.error("Newsletter error:", err);
                showBanner("Network error, please try again.", "error");
              }
            });
          });
        });
      </script>

      <section class="newsletter-popup-area-section">
        <div class="newsletter-popup-area">
          <div class="newsletter-popup-ineer">
            <button class="btn newsletter-close-btn">
              <i class="fal fa-times"></i>
            </button>
            <div class="img-holder">
              <img src="assets/img/bg/newsletter.jpg" alt />
            </div>
            <div class="details">
              <h4>Get 45% discount shipped to your inbox</h4>
              <p>
                Subscribe to the radios eCommerce newsletter to receive timely
                updates to your favorite products
              </p>
              <form>
                <div>
                  <input type="email" placeholder="Enter your email" />
                  <button type="submit">Subscribe</button>
                </div>
                <div>
                  <label class="checkbox-holder">
                    Don't show this popup again!
                    <input type="checkbox" class="show-message" />
                    <span class="checkmark"></span>
                  </label>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>

      <div class="cookies-area">
        <p>
          This website uses cookies to improve your experience. By using this
          website you agree to our <a href="#">Data Protection Policy</a>.
        </p>
        <a href="#" class="read-more">Read more</a>
        <div>
          <button class="cookie-btn">Accept</button>
        </div>
      </div>
    </div>

    <script src="assets/js/jquery-3.5.1.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/slick.js"></script>
    <script src="assets/js/backToTop.js"></script>
    <script src="assets/js/uikit.min.js"></script>
    <script src="assets/js/resize-sensor.min.js"></script>
    <script src="assets/js/theia-sticky-sidebar.min.js"></script>
    <script src="assets/js/wow.min.js"></script>
    <script src="assets/js/jqueryui.js"></script>
    <script src="assets/js/touchspin.js"></script>
    <script src="assets/js/countdown.js"></script>
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <script src="assets/js/metisMenu.min.js"></script>
    <script src="assets/js/main.js"></script>
  </body>
</html>
